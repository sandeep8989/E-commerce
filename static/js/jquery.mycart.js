!function(v){function e(t){var i=b.getOptions(),e=v("."+i.classCartIcon),d=v("."+i.classCartBadge),o=i.classProductQuantity,r=i.classProductRemove,a=i.classCheckoutCart,n="my-cart-modal",c="my-cart-table",s="my-cart-grand-total",u="my-cart-empty-message",l="my-cart-discount-price",m="my-product-total",g="my-cart-icon-affix";function y(){var e=v("#"+c);e.empty();var t=C.getAllProducts();v.each(t,function(){var t=this.quantity*this.price;e.append('<tr title="'+this.summary+'" data-id="'+this.id+'" data-price="'+this.price+'"><td class="text-center" style="width: 30px;"><img width="30px" height="30px" src="'+this.image+'"/></td><td>'+this.name+'</td><td title="Unit Price" class="text-right">'+i.currencySymbol+P.getRoundedNumber(this.price)+'</td><td title="Quantity"><input type="number" min="1" style="width: 70px;" class="'+o+'" value="'+this.quantity+'"/></td><td title="Total" class="text-right '+m+'">'+i.currencySymbol+P.getRoundedNumber(t)+'</td><td title="Remove from Cart" class="text-center" style="width: 30px;"><a href="javascript:void(0);" class="btn btn-xs btn-danger '+r+'">X</a></td></tr>')}),e.append(t.length?'<tr><td></td><td><strong>Total</strong></td><td></td><td></td><td class="text-right"><strong id="'+s+'"></strong></td><td></td></tr>':'<div class="alert alert-danger" role="alert" id="'+u+'">Your cart is empty</div>');var a=i.getDiscountPrice(t,C.getTotalPrice(),C.getTotalQuantity());t.length&&null!==a&&e.append('<tr style="color: red"><td></td><td><strong>Total (including discount)</strong></td><td></td><td></td><td class="text-right"><strong id="'+l+'"></strong></td><td></td></tr>'),p(),f()}i.cartItems&&i.cartItems.constructor===Array&&(C.clearProduct(),v.each(i.cartItems,function(){C.setProduct(this.id,this.name,this.summary,this.price,this.quantity,this.image)})),d.text(C.getTotalQuantity()),v("#"+n).length||v("body").append('<div class="modal fade" id="'+n+'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button><h4 class="modal-title" id="myModalLabel"><span class="glyphicon glyphicon-shopping-cart"></span> My Cart</h4></div><div class="modal-body"><table class="table table-hover table-responsive" id="'+c+'"></table></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-primary '+a+'">Checkout</button></div></div></div></div>');var h,p=function(){v("#"+s).text(i.currencySymbol+P.getRoundedNumber(C.getTotalPrice()))},f=function(){v("#"+l).text(i.currencySymbol+P.getRoundedNumber(i.getDiscountPrice(C.getAllProducts(),C.getTotalPrice(),C.getTotalQuantity())))};i.affixCartIcon&&(h=+e.offset().top+ +e.css("height").match(/\d+/),e.css("position"),v(window).scroll(function(){v(window).scrollTop()>=h?e.addClass(g):e.removeClass(g)})),e.click(function(){i.showCheckoutModal?(y(),v("#"+n).modal("show")):i.clickOnCartIcon(e,C.getAllProducts(),C.getTotalPrice(),C.getTotalQuantity())}),v(document).on("input","."+o,function(){var t=v(this).closest("tr").data("price"),e=v(this).closest("tr").data("id"),a=v(this).val();v(this).parent("td").next("."+m).text(i.currencySymbol+P.getRoundedNumber(t*a)),C.updatePoduct(e,a),d.text(C.getTotalQuantity()),p(),f()}),v(document).on("keypress","."+o,function(t){38!=t.keyCode&&40!=t.keyCode&&t.preventDefault()}),v(document).on("click","."+r,function(){var t=v(this).closest("tr"),e=t.data("id");t.hide(500,function(){C.removeProduct(e),y(),d.text(C.getTotalQuantity())})}),v(document).on("click","."+a,function(){C.getAllProducts().length?(v.each(v("."+o),function(){var t=v(this).closest("tr").data("id");C.updatePoduct(t,v(this).val())}),!1!==i.checkoutCart(C.getAllProducts(),C.getTotalPrice(),C.getTotalQuantity())&&(C.clearProduct(),d.text(C.getTotalQuantity()),v("#"+n).modal("hide"))):v("#"+u).fadeTo("fast",.5).fadeTo("fast",1)}),v(document).on("click",t,function(){var t=v(this);i.clickOnAddToCart(t);var e=t.data("id"),a=t.data("name"),o=t.data("summary"),r=t.data("price"),n=t.data("quantity"),c=t.data("image");C.setProduct(e,a,o,r,n,c),d.text(C.getTotalQuantity()),i.afterAddOnCart(C.getAllProducts(),C.getTotalPrice(),C.getTotalQuantity())})}var t,a,o,r,b=(o={currencySymbol:"$",classCartIcon:"my-cart-icon",classCartBadge:"my-cart-badge",classProductQuantity:"my-product-quantity",classProductRemove:"my-product-remove",classCheckoutCart:"my-cart-checkout",affixCartIcon:!(a=null),showCheckoutModal:!0,numberOfDecimals:2,cartItems:null,clickOnAddToCart:function(t){},afterAddOnCart:function(t,e,a){},clickOnCartIcon:function(t,e,a,o){},checkoutCart:function(t,e,a){return!1},getDiscountPrice:function(t,e,a){return null}},(t={}).loadOptions=function(t){a=v.extend({},o),"object"==typeof t&&v.extend(a,t)},t.getOptions=function(){return a},t),P=((r={}).getRoundedNumber=function(t){if(isNaN(t))throw new Error("Parameter is not a Number");t=+t;var e=b.getOptions();return t.toFixed(e.numberOfDecimals)},r),C=function(){var t={};localStorage.products=localStorage.products?localStorage.products:"";function g(t){localStorage.products=JSON.stringify(t)}function y(t,e){var a,o,r,n=(a=t,o=-1,r=h(),v.each(r,function(t,e){e.id!=a||(o=t)}),o);if(n<0)return!1;var c=h();return c[n].quantity=void 0===e?+c[n].quantity+1:e,g(c),!0}var h=function(){try{return JSON.parse(localStorage.products)}catch(t){return[]}};return t.getAllProducts=h,t.updatePoduct=y,t.setProduct=function(t,e,a,o,r,n){return void 0===t?(console.error("id required"),!1):void 0===e?(console.error("name required"),!1):void 0===n?(console.error("image required"),!1):v.isNumeric(o)?v.isNumeric(r)?(a=void 0===a?"":a,void(y(t)||(c=t,i=e,d=a,s=o,u=r,l=n,(m=h()).push({id:c,name:i,summary:d,price:s,quantity:u,image:l}),g(m)))):(console.error("quantity is not a number"),!1):(console.error("price is not a number"),!1);var c,i,d,s,u,l,m},t.clearProduct=function(){g([])},t.removeProduct=function(a){var t=h(),t=v.grep(t,function(t,e){return t.id!=a});g(t)},t.getTotalQuantity=function(){var a=0,t=h();return v.each(t,function(t,e){a+=+e.quantity}),a},t.getTotalPrice=function(){var t=h(),a=0;return v.each(t,function(t,e){a+=e.quantity*e.price,a=+P.getRoundedNumber(a)}),a},t}();v.fn.myCart=function(t){return b.loadOptions(t),e(this.selector),this}}(jQuery);